<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Questions - SheHealth</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
body { font-family:'Inter',sans-serif; margin:0; background:#f3e8ff; padding:20px; }
.container { max-width:800px; margin:0 auto; }
h2 { text-align:center; color:#6b46c1; }
.question-card { background:#fff; padding:15px 20px; border-radius:10px; margin-bottom:15px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
.question-title { font-weight:600; font-size:16px; margin-bottom:5px; }
.question-body { font-size:14px; margin-bottom:10px; }
.question-meta { display:flex; justify-content:space-between; align-items:center; font-size:13px; color:#555; }
.upvote-btn { background:#ff9acc; border:none; padding:5px 12px; border-radius:6px; color:white; cursor:pointer; }
.upvote-btn.upvoted { background:#e87fa3; }
.comment-count { font-style:italic; }
.back-btn { display:inline-block; margin-bottom:15px; padding:6px 12px; background:#6b46c1; color:white; border-radius:6px; text-decoration:none; }
.back-btn:hover { background:#5935a1; }
</style>
</head>
<body>

<div class="container">
  <a class="back-btn" href="index.html">‚Üê Back to Chat</a>
  <h2>Questions</h2>
  <div id="questionsList"></div>
</div>

<script>
const userId = localStorage.getItem('userId') || 'User_' + Math.floor(Math.random()*10000);
localStorage.setItem('userId', userId);

async function loadQuestions() {
  const res = await fetch('/api/questions');
  const data = await res.json();
  const container = document.getElementById('questionsList');
  container.innerHTML = '';

  data.questions.forEach(q => {
    const div = document.createElement('div');
    div.className = 'question-card';
    
    const hasUpvoted = q.upvotes.includes(userId);
    
    div.innerHTML = `
      <div class="question-title">${q.title}</div>
      <div class="question-body">${q.body}</div>
      <div class="question-meta">
        <button class="upvote-btn ${hasUpvoted ? 'upvoted' : ''}" data-id="${q._id}">
          ‚ñ≤ Upvote (${q.upvotes.length})
        </button>
        <span class="comment-count">üí¨ ${q.comments.length} comments</span>
      </div>
    `;
    
    container.appendChild(div);
  });

  document.querySelectorAll('.upvote-btn').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const id = btn.getAttribute('data-id');
      const res = await fetch(`/api/questions/upvote/${id}`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({userId})
      });
      const data = await res.json();
      if(data.success) loadQuestions();
      else alert(data.message);
    });
  });
}

loadQuestions();
</script>

</body>
</html>
